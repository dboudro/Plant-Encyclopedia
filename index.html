<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <link rel="icon" href="../favicon.png">
  <link rel="stylesheet" type="text/css" href="css/index.css">
  <link rel="stylesheet" href="build/tailwind.css">
    <link rel="stylesheet" href="https://use.typekit.net/ggk0vlq.css">
  <script src="js/dendrogram.js"></script>
</head>

<body>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-icons/3.0.1/iconfont/material-icons.min.css" integrity="sha256-x8PYmLKD83R9T/sYmJn1j3is/chhJdySyhet/JuHnfY=" crossorigin="anonymous" />
<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<style>
  html,
body {
  font-family: "Rubik", sans-serif;
}

/* navigation 
 - show navigation always on the large screen devices with (min-width:1024)
*/

@media (min-width: 1024px) {
  .top-navbar {
    display: inline-flex !important;
  }
}

</style>

<nav class="flex items-center bg-green-800 p-3 flex-wrap">
      <a href="#" class="p-2 mr-4 inline-flex items-center">
        <svg
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          class="fill-current text-white h-8 w-8 mr-2"
        >
          <path
            d="M12.001 4.8c-3.2 0-5.2 1.6-6 4.8 1.2-1.6 2.6-2.2 4.2-1.8.913.228 1.565.89 2.288 1.624C13.666 10.618 15.027 12 18.001 12c3.2 0 5.2-1.6 6-4.8-1.2 1.6-2.6 2.2-4.2 1.8-.913-.228-1.565-.89-2.288-1.624C16.337 6.182 14.976 4.8 12.001 4.8zm-6 7.2c-3.2 0-5.2 1.6-6 4.8 1.2-1.6 2.6-2.2 4.2-1.8.913.228 1.565.89 2.288 1.624 1.177 1.194 2.538 2.576 5.512 2.576 3.2 0 5.2-1.6 6-4.8-1.2 1.6-2.6 2.2-4.2 1.8-.913-.228-1.565-.89-2.288-1.624C10.337 13.382 8.976 12 6.001 12z"
          />
        </svg>
        <span class="text-xl text-white font-bold uppercase tracking-wide"
          >Plants Encyclopedia</span
        >
      </a>
      <button
        class="text-white inline-flex p-3 hover:bg-green-900 rounded lg:hidden ml-auto hover:text-white outline-none nav-toggler"
        data-target="#navigation"
      >
        <i class="material-icons">menu</i>
      </button>
      <div
        class="hidden top-navbar w-full lg:inline-flex lg:flex-grow lg:w-auto"
        id="navigation"
      >
        <div
          class="lg:inline-flex lg:flex-row lg:ml-auto lg:w-auto w-full lg:items-center items-start  flex flex-col lg:h-auto"
        >
          <a
            href="#"
            class="lg:inline-flex lg:w-auto w-full px-3 py-2 rounded text-green-100 items-center justify-center hover:bg-green-900 hover:text-white"
          >
            <span>Home</span>
          </a>
          <a
            href="#"
            class="lg:inline-flex lg:w-auto w-full px-3 py-2 rounded text-green-100 items-center justify-center hover:bg-green-900 hover:text-white"
          >
            <span>About</span>
          </a>
          <a
            href="#"
            class="lg:inline-flex lg:w-auto w-full px-3 py-2 rounded text-green-100 items-center justify-center hover:bg-green-900 hover:text-white"
          >
            <span>Services</span>
          </a>
          <a
            href="#"
            class="lg:inline-flex lg:w-auto w-full px-3 py-2 rounded text-green-100 items-center justify-center hover:bg-green-900 hover:text-white"
          >
            <span>Gallery</span>
          </a>
          <a
            href="#"
            class="lg:inline-flex lg:w-auto w-full px-3 py-2 rounded text-green-100 items-center justify-center hover:bg-green-900 hover:text-white"
          >
            <span>Products</span>
          </a>
          <a
            href="#"
            class="lg:inline-flex lg:w-auto w-full px-3 py-2 rounded text-green-100 items-center justify-center hover:bg-green-900 hover:text-white"
          >
            <span>Contact Us</span>
          </a>
        </div>
      </div>
    </nav>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
<script>
  $(document).ready(function() {
  $(".nav-toggler").each(function(_, navToggler) {
    var target = $(navToggler).data("target");
    $(navToggler).on("click", function() {
      $(target).animate({
        height: "toggle"
      });
    });
  });
});

</script>
<div id="left-page-container">
  <img class="" src="img/argemone.jpg" id="plant-picture"/>
  <h1 class="text-3xl" id="common-name"> Oregano </h1>
  <h2 class="text-3xl"id="scientific-name"> Origanum Vulgare </h2>
</div>

<div id="right-page-container">
<h2> DESCRIPTION </h2>
<p id="plant-description" class="w-2/3 text-xl"> Oregano (scientific name Origanum vulgare) is a common species of Origanum, a genus of the mint family (Lamiaceae). It is native to temperate western and southwestern Eurasia and the Mediterranean region.
Oregano is a perennial herb, growing from 20–80 cm (7.9–31.5 in) tall, with opposite leaves 1–4 cm (0.39–1.57 in) long. Oregano will grow in a pH range between 6.0 (mildly acidic) and 9.0 (strongly alkaline),
 with a preferred range between 6.0 and 8.0. The flowers are purple, 3–4 mm (0.12–0.16 in) long, produced in erect spikes. It is sometimes called wild marjoram, and its close relative O. majorana is known as sweet marjoram.
</p>

<h2 id="taxonomy"> TAXONOMY</h2>
<div id="dendrogram-container"> </div>

<div id="search-box">

<input class="bg-gray-200 appearance-none border-2 border-gray-200 rounded py-2 px-4 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-green-500" placeholder="search for a plant by scientific name" type="text"></input>

</div>

</div>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script>
/// ///////////////////////// SECTION 1: PARSING CSV ////////////////////////////
let csvData
let plantName
let plantImg
let plantDescription

// taxonomy variables
let plantOrder
let plantFamily
let plantGenus
let plantSpecies

// An array of strings; list of all plant names
let plantNames = []

function drawFromCSV (plantIndex) {
  d3.csv('plantOutput.csv', function (error, rows) {
    if (error) { console.log(error.stack) }
    // populate variables with data from CSV
    csvData = rows
    plantName = csvData[plantIndex].name
    plantImg = csvData[plantIndex].image
    plantDescription = csvData[plantIndex].paragraph
    plantOrder = csvData[plantIndex].order
    plantFamily = csvData[plantIndex].family
    plantGenus = csvData[plantIndex].genus
    plantSpecies = csvData[plantIndex].species

    // html container definition
    let commonName = document.getElementById('common-name')
    let scientificName = document.getElementById('scientific-name')
    let plantPicture = document.getElementById('plant-picture')
    let plantParagraph = document.getElementById('plant-description')

    // populate HTML containers with data from CSV
    commonName.innerHTML = plantName
    scientificName.innerHTML = plantSpecies
    plantPicture.setAttribute('src', plantImg)
    plantParagraph.innerHTML = plantDescription.replace(/(<([^>]+)>)/ig, '')

    // create a list of all plantNames
    for (let i = 0; i < csvData.length; i++) { plantNames.push(csvData[i].name) }

    // draw a taxonomy dendrogram from the relevant plant data, and append
    // it to the html document in the #dendrogram-container div
    drawDendrogram(plantOrder, plantFamily, plantGenus, plantSpecies)
    function appendDendro () {
      let dendroContainer = document.getElementById('dendrogram-container')
      let viz = document.getElementsByTagName('svg')[0]
      dendroContainer.appendChild(viz)
    }
    appendDendro()
  })
}
drawFromCSV(341)

/// //////////////////// SECTION 2: SEARCH & AUTOCOMPLETE //////////////////////

let searchBar = document.body.getElementsByTagName('input')[0]
let searchitems = document.body.getElementsByClassName('search-item')

// return (boolean) if the plant string includes the search query
function plantMatch (plant) {
  return plant.toLowerCase().includes(searchBar.value.toLowerCase())
}

/* Delete the autcomplete divs when no search query (.search-item) */
function deleteBoxes () {
  while (searchitems[0]) {
    console.log('deleting search boxes')
    let searchContainer = document.getElementById('search-box')
    searchContainer.removeChild(searchitems[0])
  }
}

// Remove the old dendrogram when updating the view with new plant data
function removeOldDendro () {
  let dendroContainer = document.getElementById('dendrogram-container')
  let oldSVG = document.getElementsByTagName('svg')[0]
  dendroContainer.removeChild(oldSVG)
}

/// // Search Bar Key Event :: Autocomplete Functionality
searchBar.addEventListener('keyup', function (event) {
  /* delete the previously recommended autocomplete */
  deleteBoxes()
  if (searchBar.value.length > 1) {
    let plantMatches = plantNames.filter(plantMatch)
    let uniquePlants = plantMatches.filter(function (item, index) {
      return plantMatches.indexOf(item) >= index
    })
    console.log('plantmatches:', uniquePlants)
    for (let i = 0; i < uniquePlants.length; i++) {
      let autocompleteItem = document.createElement('div')
      let searchbox = document.getElementById('search-box')
      searchbox.appendChild(autocompleteItem)
      autocompleteItem.setAttribute('class', 'search-item')
      autocompleteItem.innerHTML = uniquePlants[i]

      /// // Click Event: Select a new plant from the autocomplete list
      autocompleteItem.onclick = function () {
        removeOldDendro()
        drawFromCSV(plantNames.indexOf(autocompleteItem.innerHTML))
        deleteBoxes()
        searchBar.value = ''
      }
    }
  }
}, 1000)
</script>
